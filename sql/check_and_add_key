-- CREATE TABLE AV_ASSET_RRR_DETAILS_T01 (ID NUMBER);
-- INSERT INTO AV_ASSET_RRR_DETAILS_T01 VALUES (1);
-- INSERT INTO AV_ASSET_RRR_DETAILS_T01 VALUES (2);
-- INSERT INTO AV_ASSET_RRR_DETAILS_T01 VALUES (3);
-- ALTER TABLE AV_ASSET_RRR_DETAILS_T01 ADD CONSTRAINT AV_ASSET_RRR_DETAILS_T01_UNIQUE_PERSONENNUMMER_MANDANTENID UNIQUE (ID);
-- ALTER TABLE AV_ASSET_RRR_DETAILS_T01 DROP CONSTRAINT AV_ASSET_RRR_DETAILS_T01_UNIQUE_PERSONENNUMMER_MANDANTENID;


DECLARE
    INDEX_COUNT number;
BEGIN
    begin
        select count(CONSTRAINT_NAME)
        into INDEX_COUNT
        from USER_CONS_COLUMNS
        where TABLE_NAME = 'AV_ASSET_RRR_DETAILS_T01'
          and CONSTRAINT_NAME = 'AV_ASSET_RRR_DETAILS_T01_UNIQUE_PERSONENNUMMER_MANDANTENID'
        group by CONSTRAINT_NAME;
    exception
        when others then INDEX_COUNT := 0;
    end;

    IF INDEX_COUNT = 0 THEN
        EXECUTE IMMEDIATE 'ALTER TABLE AV_ASSET_RRR_DETAILS_T01 ADD CONSTRAINT AV_ASSET_RRR_DETAILS_T01_UNIQUE_PERSONENNUMMER_MANDANTENID UNIQUE (Id)';
    END IF;
END;

select CONSTRAINT_NAME
from USER_CONS_COLUMNS
where TABLE_NAME = 'AV_ASSET_RRR_DETAILS_T01'
group by CONSTRAINT_NAME;
